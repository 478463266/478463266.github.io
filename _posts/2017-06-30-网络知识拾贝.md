---
layout: post
title: 计算机网络知识拾贝 
categories: 学术
description: 论文阅读过程中总结的计算机网络知识
keywords: SDN
---

## 计算机网络知识

* 互联网中的流量路径是没有最优路径的。
* BGP：域间路由的实际标准，但协议设计没有考虑QoS。
* 传统TE依靠虚拟电路实现，像是ATM/MPLS等技术。
* 网络功能，如防火墙，IPS(入侵防御系统)等，一般是由状态的。
* 流量整形：主要方式是队列管理，速率限制。
* 网络设计原则1：网络简单，终端复杂
* IP管理：

  * 故障管理
  * 配置管理（收集网络数据）
  * 性能管理，网络资源利用率，SLA
  * 安全管理
  * 计费管理
* RTT: 平均往返实际
* TTL: 生存周期
* DPI: 深度包检测。
* SOA: 面向服务的体系结构。
* iperf：网络性能测试工具。可以测试最大TCP/UDP带宽性能，如带宽、延迟、抖动和数据包丢失等。


  > [iperf使用方法](http://www.cnblogs.com/kungfupanda/p/3182515.html)

* PBB(Provider Backbone Bridge): 2层较厚技术，运营商骨干桥接技术。传输通道是基于TLS。
* TLS: 安全传输层协议（*TLS*）用于在两个通信应用程序之间提供保密性和数据完整性。
* SSL(Secure Socket Layer，安全套接字层): 位于可靠的面向连接的网络层协议和应用层协议之间的一种协议层。
* 桥接技术：基于链路层地址，对数据包进行转发，工作在第二层。交换机、网桥有桥接作用。
* 生成树算法STA：路由计算。
* Captive portal：在新用户授权访问网络资源前的web登录页面，一般用于WiFi网络的访问控制，详见[维基百科](https://en.wikipedia.org/wiki/Captive_portal)
* IP-CAB(IP-Connectivity Access Network)：通过IP实现UE与IMS实体之间的连通的网络实体和接口的集合， 典型的例子就是GPRS，通常使用于峰窝、WLAN或DSL网络，注重接入与业务网络的分离，详见[维基百科](https://baike.baidu.com/item/IP-CAN/8449769?fr=aladdin)。
* 一种网络设计思路：**业务、控制、承载**完全分离。
* Yang模型：NETCONF(基于xml的网络配置协议)的内容层建模语言，可以对IOT服务建模。
* 7种常见的网络应用：最短路径路由，负载均衡，防火墙，nat，energy saving，最小带宽保证，rate limit和waypoint。
* 网络目前发展趋势，从静态到动态，这样对安全策略、服务质量，性能(可扩展性)等有了更高的要求，而SDN优势是降低capex和opex，让数据中心、企业和服务提供商更加灵活、智能和快速。
* 网络应用的流量要求

> * 文件应用：高吞吐量
> * 音频服务：低延迟
> * 视频流：低跃变jitter

* Network Partition：网络分区一般是指导致网络给分割的网络设备的故障。比如在具有多个子网的网络中，其中节点A和B位于一个子网中，节点C和D位于另一个子网中，如果两个子网之间的交换机发生故障，则会发生分区。在这种情况下，节点A和B不能再与节点C和D通信。分区容错机制可以避免这些现象，理论机制包括CAP trade-off，在一致性、可用性和分区容忍上取得平衡。

> * 有状态：有数据存储功能
> * 无状态：一次操作，不保存数据

> * 实时网络应用：VoIP, network gaming,IPTV, and media streaming require a bounded end-to-enddelay to meet quality of service requirements

* 网络性能分析指标

> 1. 数据包投递率(Packet Delivery Ratio，PDR)：PDR为源节点应用层发送的数据(包)(Ps)与目标节点接收到的数据(包)(Pr)的比值关系，即正确传输数据包的统计度量。其能体现MANET的两个主要特性：(1)网络可靠性；(2)网络拥塞/通信状况。 PDR=Pr/Ps
> 2. 路由代价(Routing Overhead，RO)：RO为路由消息(协议包)占网络中总通信数据(协议包和数据包)的比值，即所有节点发送和转发的协议包(Rsf)与其数据包(Psf)的比值。该度量能反映路由协议对网络通信的影响。 RO=Rsf/ (Rsf+Psf) 
> 3. 归一化路由代价(Normalized Routing Overhead，NRO)：NRO为发送一个数据包(包括源发送和中间转发)到目标节点需要的路由包的数量，即发送和转发的协议包(Rsf)与数据包(Psf)的比值。该度量反映了网络路由的稳定性。 NRO=Rsf/ Psf 
> 4. 平均跳数(路径长度(Path length，PL))：PL为平均每个数据包传输需要的路径长度，即数据包发送和转发的次数(Psf)与数据包发送次数(Ps)的比值。 PL=Psf/ Ps 
> 5. .吞吐量(Throughput，TH)：TH为单位时间内从源到目标传输的数据量，可分为节点吞吐量(Noth)和网络吞吐量(Neth)，其中节点吞吐量为目标节点单位时间内接收到的数据包，网络吞吐量为单位时间内网络中所有节点接收到的数据包总和的平均值。 Noth= 节点接收到的总数据包 / (开始接收时间 – 最后接收时间) Neth= 所有接收节点的Noth之和 / 接收节点数
> 6. 延迟(Delay，DE)：DE为数据包从源发送到目标正确传输需要的时间(Dp)，其平均值为平均延迟(ADp)。 ADp= 所有Dp之和 / 正确传输的数据包数量
> 7. 能量消耗(Energy Consumption，EC)：EC为节点消耗的能量比例，所有节点的EC平均值为平均能量消耗(AEC)。 Nec= (节点初始能量 – 节点最终能量) / (节点初始能量) Naec= 所有Nec之和 / 节点数量
> 8. 文件投递率(File Delivery Ratio，FDR)：FDR为TCP成功传输文件的比率，所有TCP传输成功率的均值为平均文件传输成功率(AFDR)。 
>    FDR= TCP成功传输文件数 / TCP传输文件总数 AFDR= 所有FDR之和 / TCP连接数量
> 9. 文件投递延迟(File Delivery Delay，FDD)：FDD为TCP成功传输文件的延迟，AFDD为TCP成功传输文件延迟的平均值，TAFDD为所有TCP连接成功传输文件延迟的平均值。 
>    AFDD= TCP成功传输的文件延迟之和 /TCP成功传输文件数 TAFDD= 所有AFDD之和 / TCP连接数量

* the link between any two nodes in the network is affected by propagation path loss, shadowing and additive white Gaussian noise (AWGN).
* 汉明距离:表示两个（相同长度）字对应位不同的数量。对两个字符串进行异或运算，并统计结果为1的个数，那么这个数就是汉明距离。常用于差错控制等领域。
* The Internet is a game among ISPs, ICPs, governments and users [Rethinking the design of the Internet: the end to end arguments vs. the brave new world].
* 路径的建立：路由、安全、QoS和资源管理等需求。
* Two key features of real networks: incorporate growth and preferential attachment. 
* Growth and preferential attachment are mechanisms common to a number of complex systems, including business networks, social networks (describing individuals or organizations), transportation networks, etc.
* scale-free network：常用于IoT仿真、社交网络（集线器）等场景中，网络节点度 服从power law
* AAA协议：访问控制概念，AAA是鉴别，授权和记账(Authentication， Authorization， Accounting)的简称。一种实现方式是[Radius协议](https://blog.csdn.net/a6877321/article/details/72825544)
* EAP (Extensible Authentication Protocol): 一种广泛应用于无线网络和点对点连接的 授权框架。它只定义消息格式，常见的封装方法则包括IEEE 802.1X
* IEEE 802.X：基于接口的网络访问控制协议，为访问WLAN和LAN的设备提供授权机制。具体原理介绍见[维基百科](https://en.wikipedia.org/wiki/IEEE_802.1X) 
* 网络体系结构：应该是**通用处理器**和**异构计算硬件并存**的模式。异构硬件牺牲了部分通用计算能力，使用专用加速单元减小了某一类或多类负载的执行时间，并且显著提高了**性能功耗比**。
* 网络流量类型：计算流量，存储流量，业务数据流量
* 网络发展趋势：伴随着移动互联网的发展，每年新增的网络流量达到**ZB量级**；存储介质已从机械硬盘演进到固态硬盘，计算已从CPU，GPU，再到专用的ASIC芯片，计算和存储性能提升了百倍以上，同时，网络时延在端到端时延中占比**从10%增加到60%以上**，网络性能再不提升就会成为计算和存储效率的进一步提升的瓶颈
* 网络指标分析：时延，丢包，吞吐。时延可以分为服务器侧处理时延，网络传输时延。丢包很大可能性是以太网拥塞导致的。吞吐量取决于两个方面，一是带宽，二是拥塞场景下的buffer利用率。目标是低时延、无丢包、高吞吐。

> 三者的关系：
>
> - 无丢包：会抑制带宽，导致超低吞吐，反而增加了“大象流”的传输时延；
> - 低时延：意味着降低交换机队列排队，导致低吞吐；
> - 高吞吐：意味需要保持链路高利用率，会导致交换机的拥塞排队

- 网络传输时延分析：时延不仅仅是指网络轻负载情况下的单包测试时延，而是指满负载下的实际时延，即数据流的完成时间。详细分析网络时延构成可分为：静态时延和动态时延两类。

> 详细解释：静态时延包括数据串行时延、设备转发时延和光电传输时延。这类时延由交换芯片的转发能力和链路传输的距离决定，而这类时延具有确定的规格，目前普遍为ns级，在网络总时延占比小于1%。比如，芯片转发时延达到几百纳秒，就是指静态单包时延。但还要认识到对于网络性能影响更大的是动态时延，占比超过99%。
>
> 动态时延包括内部排队时延和丢包重传时延，这类时延由网络拥塞和丢包引起。一旦发生报文拥塞排队或者丢包，时延最差会达到秒级，所以关键在于降低动态时延。降低动态时延的关键在于更好的解决拥塞和丢包问题。

- 网络拥塞常见原因：
  - 在进行数据中心网络架构设计时，从成本和收益两方面来考虑，多数会采取非对称带宽设计，即上下行链路带宽不一致，交换机的收敛比简单说就是总的输入带宽除以总的输出带宽
  - Incast是Many-to-one的通信模式，在高性能数据中心中，这种通信模式常常发生，尤其是那些以Scale-Out方式实现的分布式存储和计算应用，包括Hadoop，MapReduce，HDFS等。一般是Parent Server的出端口缓存不足，造成拥塞
- 网络丢包分析：以太网本质上是无连接的，无法保证报文传输的可靠性。在缓冲区拥塞而产生的丢包的情况下，报文无法转发到接收方，因此如果没有能提供流量控制的协议，就可能由于交换机缓冲区拥塞导致丢失过多的报文，带来业务质量严重下降
- 网络吞吐量分析：由于存在网络拥塞，单纯的增加带宽并不能提升应用性能，在带宽增长的同时保证链路吞吐量才是出路
- [无损网络](https://www.sdnlab.com/23042.html)：可实现以上三个目标的新型技术。主要技术包括：RDMA、PFC和ECN等。其中RDMA技术是一种直接在内存和内存之间进行资料互传的技术，在数据中传输的过程中，CPU不必做操作，完全实现了Kernel Bypass（无需操作系统和TCP/IP协议栈的介入），可以带来低时延、降低CPU消耗的好处。技术标准：RoCE。
- 网络架构两侧纵向的支撑服务：管理+安全
- 网络连接模式：
  - 桥接：虚拟机的虚拟网络适配器与主机的物理网络适配器进行交接，虚拟机中的虚拟网络适配器可通过主机中的物理网络适配器直接访问到外部网。这就好像在上图所示的局域网中添加了一台**新的、独立**的计算机一样。因此，虚拟机也会占用局域网中的一个IP地址，并且可以和其他终端进行相互访问。桥接模式网络连接支持有线和无线主机网络适配器。如果你想把虚拟机当做一台完全独立的计算机看待，并且允许它和其他终端一样的进行网络通信，那么桥接模式通常是虚拟机访问网络的最简单途径。
  - NAT: 在主机上建立单独的专用网络，用以在主机和虚拟机之间相互通信。虚拟机向外部网络发送的请求数据"包裹"，都会交由NAT网络适配器加上"特殊标记"并以主机的名义转发出去，外部网络返回的响应数据"包裹"，也是先由主机接收，然后交由NAT网络适配器根据"特殊标记"进行识别并转发给对应的虚拟机，因此，虚拟机在外部网络中不必具有自己的IP地址。从外部网络来看，虚拟机和主机在共享一个IP地址，默认情况下，外部网络终端也无法访问到虚拟机。此外，在一台主机上只允许有一个NAT模式的虚拟网络。因此，同一台主机上的多个采用NAT模式网络连接的虚拟机也是可以相互访问的。但是，可以通过手动修改NAT设置实现端口转发功能，将外部网络发送到主机指定端口的数据转发到指定的虚拟机上。比如，我们在虚拟机的80端口上"建立"了一个站点，只要我们设置端口转发，将主机88端口上的数据转发给虚拟机的80端口，就可以让外部网络通过主机的88端口访问到虚拟机80端口上的站点
  - 主机：主机模式，是一种比NAT模式更加封闭的的网络连接模式，它将创建完全包含在主机中的专用网络。仅主机模式的虚拟网络适配器仅对主机可见，并在虚拟机和主机系统之间提供网络连接。相对于NAT模式而言，仅主机模式不具备NAT功能，因此在默认情况下，使用仅主机模式网络连接的虚拟机无法连接到Internet(在主机上安装合适的路由或代理软件，或者在Windows系统的主机上使用Internet连接共享功能，仍然可以让虚拟机连接到Internet或其他网络)。在同一台主机上可以创建多个仅主机模式的虚拟网络，如果多个虚拟机处于同一个仅主机模式网络中，那么它们之间是可以相互通信的；如果它们处于不同的仅主机模式网络，则默认情况下无法进行相互通信(可通过在它们之间设置路由器来实现相互通信)
  - 形象的说，桥接模式的虚拟机，就像一个在路由器"民政局"那里"上过户口"的成年人，有自己单独的居住地址，虽然和主机住在同一个大院里，但好歹是有户口的人，可以大摇大摆地直接和外面通信。NAT模式的虚拟机，纯粹就是一个没上过户口的黑户，路由器"民政局"根本不知道有这么个人，自然也不会主动和它通信。即使虚拟机偶尔要向外面发送点的信件，都得交给主机以主机的名义转发出去，主机还专门请了一位叫做NAT的老大爷来专门负责这些虚拟机的发信、收信事宜。仅主机模式的虚拟机，纯粹是一个彻彻底底的黑奴，不仅没有户口、路由器"民政局"不知道这么号人，还被主机关在小黑屋里，连信件也不准往外发。













